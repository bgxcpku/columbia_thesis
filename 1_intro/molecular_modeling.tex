Molecular modeling seeks to gain new insights into the real world behavior of molecules by mimicking these molecules, usually using computer simulations.
According to the theory of ``minimal frustration'' the protein native state is not only a low energy state, but is also stable \cite{bryngelson1987spin}.
So the prediction of native or native-like conformations focuses on finding those conformations which have a low potential energy.
As measuring the true potential energy of a system is very difficult or impossible computational models seek to reproduce the qualitative behavior of the energy surface.
Quantum mechanics calculations are often viewed as the gold standard with respect to intramolecular energy calculations.
However, despite the accuracy of quantum mechanics, its application to large systems such as proteins is currently limited due to the amount of time necessary to perform quantum mechanics calculations on a large number of atoms.
Instead quantum mechanics calculations have been used to parameterize a majority of the most popular molecular mechanics force fields currently in use, including:
\begin{enumerate}
\item AMBER \cite{weiner1984new},
\item OPLS-AA \cite{kaminski1994free},
\item and CHARMM \cite{mackerell2002charmm}.
\end{enumerate}

The earliest molecular mechanics force fields either modeled groups of atoms as a unit, hydrogens being grouped with their bound heavy atom \cite{jorgensen1988opls}, or even each residue as a unit \cite{lee1999energy}, both to reduce the number of parameters in the model and to increase the speed of computations.
Although {\it ab initio} folding experiments are theoretically interesting, they are generally not practical both because of the difficulty in simulating such a large system for the time-frame necessary to observe behaviors like folding, and also because structural models for many proteins are available either directly as X-ray structures, or indirectly through homology.

\begin{figure}[h]
\begin{center}
\includegraphics[width=0.7\textwidth]{figures/conservation_of_annoyance.png}
\caption{To an extent it is always possible to either increase accuracy or decrease running time, or the cost of an experiment.
New scientific methods should allow one to increase accuracy while not spending additional time.}
\label{figure:conservation_of_annoyance}
\end{center}
\end{figure}

%\begin{figure}[h]
%    \centering
%    \begin{subfigure}[b]{0.3\textwidth}
%        \centering
%        \includegraphics[width=\textwidth]{figures/drysurf.png}
%        \label{fig:dry}
%        \caption{}
%    \end{subfigure}%
%    \begin{subfigure}[b]{0.3\textwidth}
%        \centering
%        \includegraphics[width=\textwidth]{figures/wetsurf.png}
%        \label{fig:wet}
%        \caption{}
%    \end{subfigure}
%    \caption{The protein energy surface is roughly funnel shaped}
%    \label{fig:funnel}
%\end{figure}

Because of the evolutionary cost of mis-folded proteins, proteins have been selected to minimize mis-folding, making the general shape of the potential energy surface roughly funnel shaped with the native structure at the minimum \cite{leopold1992protein}.
Despite this shape, the energy landscape of proteins is a very ``jagged'' surface with a large number of local minima \cite{tsai1999folding}.

Even the smallest enzyme contains 62 amino acids, and has thousands of degrees of freedom \cite{chen19924}, and larger enzymes are regularly more than 1000 amino acids.
The number of degrees of freedom of these systems make any attempt to analytically solve for a global minimum energy conformation impossible, and require other methods of generating plausible conformations.
In order to compensate for this a number of different sampling methods have been developed.

\subsection{Sampling Methods}
\label{subsection:sampling_methods}

\subsubsection{Monte-Carlo Sampling}
\label{subsubsection:monte_carlo}
Metropolis Monte-Carlo simulation was originally developed in the 1950's to provide rapid sampling of the solution space of many variable problems \cite{metropolis1953equation}.
\cite{hastings1970monte}
It is a commonly used method in statistical physics, statistics, sequence and structural biology.


Monte-Carlo minimization  \cite{li1987monte}.
Umbrella sampling\cite{torrie1977nonphysical}.

\subsubsection{Minimization}
\label{subsubsection:minimization}


\subsubsection{Analytic Loop Closure}
\label{subsubsection:analytic_loop_closure}
Subsequences with regular secondary structures, $\alpha$-helices and $\beta$-sheets are generally better conserved, and therefore likely to be well covered by simple homology models \cite{kolodny2005inverse}.
The intervening ``random coil'' or loop regions often play a large role in determining protein specificity for a specific ligand as in antigen-antibody binding \cite{bajorath1996comparison}, small protein toxins to the receptors they target \cite{wu1996functional}, or transcription factors to specific DNA sequences \cite{jones1999protein}.

Loop closure or prediction is a significant part of homology modeling, and building structures consistent with X-ray refraction data.
Therefore in order to accurately predict three dimensional structure through homology models, infer the protein binding partners and function, or even build a three dimensional structure consistent with both X-ray data and physical constraints, accurately predicting these loop regions is critical \cite{fiser2000modeling}.

The question is, given two fixed endpoints and a flexible loop, or actuator, find a conformation of the loop which connects the two endpoints.
Because of the similarities that this problem solves with robotics a number of algorithms have been adapted from that field \cite{kolodny2005inverse}.
The first of these is analytical loop closure, where a conformation which satisfies the closure criteria is solved for directly by solving a system of equations.
Though this problem can be solved analytically for small loops \cite{wedemeyer1999exact,go1970ring,bruccoleri1985chain,palmer1991standard}, the problem becomes more difficult as loop length grows and the number of degrees of freedom of the loop section increases.
Additionally these closure constraints make sampling multiple different conformations more difficult \cite{cortes2005sampling}, though it is possible to hierarchically solve sub-loops in order to generate conformations for possible loops \cite{wedemeyer1999exact}.

\subsubsection{Random Tweak}
\label{subsubsection:tweak}

\subsubsection{Cyclic Coordinate Descent}
\label{subsubsection:cyclic_coordinate_descent}
Another robotics algorithm which has been successfully applied to protein loop closure is Cyclic Coordinate Descent \cite{canutescu2003cyclic}.
As the length of a loop grows the number of degrees of freedom increases and the possible solution space grows exponentially. 


\cite{moult1986algorithm}



Plop like methods ? \cite{kolodny2005inverse}


Homology modeling \cite{browne1969possible}

\subsection{Energy Functions}
\label{subsection:energy_functions}
Some energy models do not seek to accurately rank potential conformations, fast ``screening'' functions attempt to quickly differentiate physically impossible conformations from plausible conformations without performing an expensive minimization or energy calculation step.
Application of these screening functions has the potential to greatly reduce the number of potential conformations that must be scored using the full detail energy function, greatly decreasing the overall cost of conformation prediction.
These screening criteria can be applied either during the sampling procedure, potentially eliminating sampling of a large area of excluded conformation space, or after sampling before a more expensive energy function is applied to rank conformations.
Effective screening criteria have a large impact on the total performance of a structure prediction method.

One of the earliest screening criteria was the hard sphere overlap collision detection \cite{levinthal1966molecular}, and this method is consistently included in screening scriteria.
Other screens include:
\begin{enumerate}
\item bounds on bond lengths and angles, as a single bond which deviates significantly from equilibrium can dominate the energy of a conformation,
\item limitations on $\phi$-$\psi$ space occuped by backbone dihedrals corresponding to the Ramachandran plot of the residue,
\item limiting side chain dihedrals to staggered conformations, which correspond to the low energy well of side chain dihedral space \cite{moult1986algorithm},
\item excluding structuctures which present excessive solvent accessible surface area, as this conflicts with the hydrophobic effect, which has a large effect on the conformation of the native state \cite{chothia1975principles}
\item limitations on the number of ``dry'' cavities, and the number of internal charged residues \cite{moult1986algorithm}
\end{enumerate}

The general form of most molecular mechanics energy potentials is reasonably consistent, with bonds and angles being modeled as a spring, dihedrals as a Fourier series.
\input{equations/opls.tex}
\input{equations/bonds.tex}
\input{equations/angles.tex}
\input{equations/dihedrals_compact.tex}
The non-bonded terms are modeled as a Columbic potential between any point charges and a Lennard-Jones or 6-12 potential between any non-bonded atoms.
These non-bonded atoms are phased in by a ``fudge factor'' for atoms in a 1-4 configuration.
\input{equations/nonbonded.tex}
Where $\sigma_{ij} = \sqrt{\sigma_{ii} \sigma_{jj}}$ and $\epsilon_{ij} = \sqrt{\epsilon_{ii}\epsilon_{jj}}$ \cite{jorgensen1996development}.






