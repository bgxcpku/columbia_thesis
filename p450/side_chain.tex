Side chain motions seek to sample different conformations of the neighboring side chains and flexible moieties attached to a static constrained central core of the ligand.
Because side chain conformations are locally highly correlated, neighboring side chains are sampled simultaneously.
First a number of side chains to be sampled is selected, for this study the possible cluster sizes were from one to three residues, all with equal probability.
Once a cluster size is selected a single side chain is selected, at random.
Until the desired cluster size is reached additional residues are selected, and rejected if the $\beta$ carbon is greater than 6 angstroms from any of the $\beta$ carbons of the residues already included in the cluster.

Once the side chains have been selected three different possible moves are possible for each side chain, these are:
\begin{enumerate}
\item rotamer library based moves
\item random perturbations of a single dihedral
\item random perturbation of all dihedrals
\end{enumerate}

For 75\% of side chains, the rotamers are replaced with rotamers drawn at random from a high resolution rotamer library.
The rotamer states for protein residues is the same library used in other place in PLOP, constructed from a set high resolution protein X-ray crystal structures \cite{xiang2001extending}.
The rotamers for the ligand are constructed by sampling rotable bonds at 10 degree resolution and screening this set for steric clashes.
In addition to the rotamer selected a small amount of ``noise'' which is random, and less than the resolution of the side chain library, is added to each rotamer.

For the remaining 25\% of side chains, moves are distributed equally between perturbations of a single dihedral and perturbations of all dihedrals.
The perturbation for each dihedral is constructed of both a small and a large perturbation.
The small perturbation is chosen at random in the range [-d,d] where d is the resolution of the side chain library, in this case 10 degrees.
This term corresponds to the ``noise'' term in the case of rotamer moves.
The large perturbation is a multiple of 60 degrees, which corresponds to the minima of both sp2 and sp3 carbons, though the null large perturbation is weighted more heavily.
The effect of the union of these two terms is that dihedrals which are expected to yield higher acceptance probabilities are selected more frequently, though with the large perturbations this is balanced with large changes in conformation.

After a set of dihedral angles has been proposed for all residues in the cluster the atomic locations are updated.
Finally, before testing for acceptance of the new coordinates a screen is a applied.
A reduced radius, 0.6x scaling factor, hard sphere overlap screening criteria is applied for all possible side chain moves before a possibly costly minimization step.
If the proposed structure does not pass the screening stage another side chain step is performed to obtain a new proposed conformation.

%Then, with user specified probabilities, clusters of different sizes are selected for the torsional moves, either with random side chain moves, or rotamer selection moves.

%For small torsion moves, a random perturbation of the angle of +/- X is made, where X is a random number with user defined magnitude.
%For large torsion moves, for each torsion angle that is changed, a random angle is selected in the form 60*Y +/- X, where Y = 1 through 5, and X is the same random number for the small torsion moves.
%The large move was introduced since positions at the top of rotamer barriers are relatively unlikely to be selected, and efficiency thus can be improved by focusing on the more probable moves.
%The ratio of small to large torsion moves can be used-adjusted, as can the ratio of probabilities of changing all the torsions in a randomly selected side chain versus changing only one single (randomly selected) torsion among all the free torsions in the simulation can be set as a user-defined parameter.
%Rotamer side chain moves: A second type of torsional samples implemented is random selection of a new rotamer state for the entire side chain, plus an optional user defined small noise term for each torsion in the rotamer state.
%A database of protein rotamer states obtained from crystallographic data are already a part of PLOP \cite{xiang2001extending} 
%Rotamer libraries for ligands are generated by examining all possible side chain conformations at 10 degree resolution and screening this set for steric clashes.
%A Monte Carlo move in this case represents a choice of a new torsional rotamer state for the entire side chain.
%Monte Carlo moves based on torsional states cannot lead to correct equilibrium distributions, as transitions from non-rotamer states to rotamer states are defined, but not reverse transitions, upsetting detailed balance.
%However, a pretabulated rotamer state is more likely to be low energy than a randomly generated torsional state, and thus allows for more diverse conformational searching.

%By varying the dihedral angles of the rotatable bonds, IDSite uses side chain MC moves in PLOP to sample the selected side-chain conformations of the protein and of the ligand.
%Up to three close residues (C beta distance within 6 angstroms) are allowed to rotate collectively, but the moves of the protein residues and those of the ligand are separated.
%In each attempted movement, the conformations of the selected side chains (from the protein/ligand) are either changed by random perturbations or assigned by the randomly selected rotamers from a library.
%For an attempt with a random perturbation, the displacement of each dihedral angle is the sum of a large rotation (N times 60 degrees with N as a random integer between 0 and 5) and a random perturbation from 0 to 30 degrees.
%For a rotamer library attempt, a side-chain conformation is updated with a random rotamer from a high resolution side-chain library for protein residues \cite{xiang2001extending}, and from a homogeneous library at 10 degree resolution for the ligand.
%If a structure with tolerable overlaps is generated in an attempt, it is minimized and sent to subsequent stages for judgment of acceptance.
%Each side-chain move takes less than 15 seconds and is the fastest among all the three move types.

%% from mike's
%Rotamer torsional moves were selected 75\% of the time, with half of the remaining being of random torsions, and the other half random perturbations of all torsions within the randomly selected side chains.
%Small torsion perturbations made +/- 60 degrees from the current dihedral angle, and were performed 5\% of the time; Large periodic moves were performed 95\% of the time.
%Minimization was performed after the single step, and acceptance was performed at 1 K.

